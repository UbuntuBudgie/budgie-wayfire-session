# Wayfire Configuration File
# This configuration is managed by wayfire_bridge.py
# Settings are synchronized from gsettings schemas
# Manual changes may be overwritten when gsettings values change

# =============================================================================
# [core] - Core Wayfire settings
# =============================================================================
[core]
# GTK theme name
# Synced from: org.gnome.desktop.interface::gtk-theme
gtk_theme = Adwaita

# Focus mode for windows
# Values: click, sloppy, mouse
# Synced from: org.gnome.desktop.wm.preferences::focus-mode
focus_mode = click

# Wayfire plugins to load (not managed by bridge)
plugins = \
  alpha \
  animate \
  autostart \
  command \
  cube \
  decoration \
  expo \
  fast-switcher \
  fisheye \
  foreign-toplevel \
  grid \
  gtk-shell \
  #idle \
  invert \
  move \
  oswitch \
  place \
  resize \
  session-lock \
  shortcuts-inhibit \
  switcher \
  vswitch \
  window-rules \
  wm-actions \
  #wobbly \
  wrot \
  zoom


# Screen brightness
# https://haikarainen.github.io/light/
#repeatable_binding_light_up = KEY_BRIGHTNESSUP
#command_light_up = light -A 5
#repeatable_binding_light_down = KEY_BRIGHTNESSDOWN
#command_light_down = light -U 5

# =============================================================================
# [input] - Input device settings (libinput)
# =============================================================================
[input]
# Cursor theme name
# Synced from: org.gnome.desktop.interface::cursor-theme
cursor_theme = Adwaita

# Cursor size in pixels
# Synced from: org.gnome.desktop.interface::cursor-size
cursor_size = 24

# --- Mouse Settings ---
# Mouse natural scrolling
# Values: true, false
# Synced from: org.gnome.desktop.peripherals.mouse::natural-scroll
natural_scroll = false

# Mouse acceleration profile
# Values: adaptive, flat
# Synced from: org.gnome.desktop.peripherals.mouse::accel-profile
mouse_accel_profile = adaptive

# Mouse cursor speed
# Range: -1.0 to 1.0
# Synced from: org.gnome.desktop.peripherals.mouse::speed
mouse_cursor_speed = 0.0

# Mouse left-handed mode
# Values: true, false
# Synced from: org.gnome.desktop.peripherals.mouse::left-handed
left_handed_mode = false

# --- Touchpad Settings (libinput) ---
# Touchpad natural scrolling
# Values: true, false
# Synced from: org.gnome.desktop.peripherals.touchpad::natural-scroll
touchpad_natural_scroll = true

# Touchpad tap-to-click
# Values: true, false
# Synced from: org.gnome.desktop.peripherals.touchpad::tap-to-click
tap_to_click = true

# Touchpad scroll method
# Values: two-finger, edge
# Synced from: org.gnome.desktop.peripherals.touchpad::two-finger-scrolling-enabled
scroll_method = two-finger

# Touchpad cursor speed
# Range: -1.0 to 1.0
# Synced from: org.gnome.desktop.peripherals.touchpad::speed
touchpad_cursor_speed = 0.0

# Touchpad left-handed mode
# Values: true, false
# Synced from: org.gnome.desktop.peripherals.touchpad::left-handed
touchpad_left_handed_mode = false

# Disable touchpad while typing
# Values: true, false
# Synced from: org.gnome.desktop.peripherals.touchpad::disable-while-typing
disable_while_typing = true

# Touchpad click method
# Values: default, none, button-areas, clickfinger
# Synced from: org.gnome.desktop.peripherals.touchpad::click-method
click_method = default

# Touchpad send events mode
# Values: enabled, disabled, disabled-on-external-mouse
# Synced from: org.gnome.desktop.peripherals.touchpad::send-events
touchpad_send_events = enabled

# --- Keyboard Settings ---
# Keyboard repeat delay (milliseconds before repeat starts)
# Synced from: org.gnome.desktop.peripherals.keyboard::delay
kb_repeat_delay = 500

# Keyboard repeat rate (characters per second)
# Calculated from: org.gnome.desktop.peripherals.keyboard::repeat-interval
# Formula: 1000 / repeat-interval (ms) = chars/sec
kb_repeat_rate = 33

# Numlock default state
# Values: true, false
# Synced from: org.gnome.desktop.peripherals.keyboard::numlock-state
kb_numlock_default_state = false

# Keyboard layout
# Synced from: org.gnome.desktop.input-sources::sources
# Example: us, gb, de, fr
xkb_layout = us

# Keyboard variant (if applicable)
# Example: dvorak, colemak
# xkb_variant = 

# Keyboard options
# Synced from: org.gnome.desktop.input-sources::xkb-options
# Example: ctrl:nocaps,compose:ralt
# xkb_options = 

# X Server Keyboard settings (for XWayland compatibility)
xkb_repeat_delay = 500
xkb_repeat_rate = 33

# =============================================================================
# [decoration] - Window decoration settings
# =============================================================================
[decoration]
# Window button order
# Example: close,minimize,maximize
# Synced from: org.gnome.desktop.wm.preferences::button-layout
button_order = close,minimize,maximize

# Title height (not managed by bridge)
title_height = 30

# Active border color (not managed by bridge)
active_color = 0.5 0.5 1.0 1.0

# Inactive border color (not managed by bridge)
inactive_color = 0.2 0.2 0.2 1.0

# =============================================================================
# [command] - Keybinding commands
# =============================================================================
[command]
# --- Window Manager Keybindings ---
# Keybinding format: KEY_X MODIFIER1 MODIFIER2 (space-separated)
# Multiple alternatives: KEY_Q ALT | KEY_F4 ALT (pipe-separated)

# Close window keybinding
# Synced from: org.gnome.desktop.wm.keybindings::close
binding_close = KEY_Q ALT
command_close = wm-actions close

# Maximize window keybinding
# Synced from: org.gnome.desktop.wm.keybindings::maximize
binding_maximize = KEY_UP LOGO
command_maximize = wm-actions maximize

# Minimize window keybinding  
# Synced from: org.gnome.desktop.wm.keybindings::minimize
binding_minimize = KEY_DOWN LOGO
command_minimize = wm-actions minimize

# Move window to workspace left
# Synced from: org.gnome.desktop.wm.keybindings::move-to-workspace-left
binding_move_left = KEY_LEFT SHIFT LOGO
command_move_left = vswitch-move left

# Move window to workspace right
# Synced from: org.gnome.desktop.wm.keybindings::move-to-workspace-right
binding_move_right = KEY_RIGHT SHIFT LOGO
command_move_right = vswitch-move right

# --- Media Keys (Static Bindings) ---
# These are synced from org.buddiesofbudgie.settings-daemon.plugins.media-keys
# Only created if a keybinding is set in gsettings

# Launch Terminal
# Synced from: org.buddiesofbudgie.settings-daemon.plugins.media-keys::terminal
# binding_launch_terminal = KEY_T CTRL ALT
# command_launch_terminal = x-terminal-emulator

# Launch Browser
# Synced from: org.buddiesofbudgie.settings-daemon.plugins.media-keys::www
# binding_launch_browser = KEY_B LOGO
# command_launch_browser = x-www-browser

# Launch Email Client
# Synced from: org.buddiesofbudgie.settings-daemon.plugins.media-keys::email
# binding_launch_email = KEY_E LOGO
# command_launch_email = xdg-email

# Launch File Manager
# Synced from: org.buddiesofbudgie.settings-daemon.plugins.media-keys::home
# binding_launch_file_manager = KEY_F LOGO
# command_launch_file_manager = nautilus

# Launch Calculator
# Synced from: org.buddiesofbudgie.settings-daemon.plugins.media-keys::calculator
# binding_launch_calculator = KEY_C LOGO
# command_launch_calculator = gnome-calculator

# Toggle Magnifier (requires mag plugin)
# Synced from: org.buddiesofbudgie.settings-daemon.plugins.media-keys::magnifier
# binding_toggle_magnifier = KEY_M ALT LOGO
# command_toggle_magnifier = wf-mag

# Lock Screen
# Synced from: org.buddiesofbudgie.settings-daemon.plugins.media-keys::screensaver
# binding_lock_screen = KEY_L LOGO
# command_lock_screen = loginctl lock-session

# -----------------------------------------------------------------------------
# CUSTOM KEYBINDINGS (dynamically managed by bridge)
# -----------------------------------------------------------------------------
# Custom keybindings are automatically created/updated/deleted when you:
# - Add custom keybindings in budgie-control-center
# - Modify existing custom keybindings
# - Remove custom keybindings
#
# The bridge monitors: org.buddiesofbudgie.settings-daemon.plugins.media-keys.custom-keybindings
#
# Example custom keybindings that would be created automatically:
#
# binding_my_terminal = KEY_T LOGO
# command_my_terminal = xfce4-terminal
#
# binding_my_browser = KEY_B LOGO
# command_my_browser = firefox
#
# Note: The binding name is derived from the keybinding name in gsettings
# (spaces and special characters are replaced with underscores)

# =============================================================================
# [gamma] - Night light / color temperature
# =============================================================================
[gamma]
# Enable night light / color temperature adjustment
# Values: true, false
# Synced from: org.gnome.settings-daemon.plugins.color::night-light-enabled
enabled = false

# Color temperature in Kelvin
# Range: 1000-10000 (typical: 3500-5500)
# Lower = warmer (more red), Higher = cooler (more blue)
# Synced from: org.gnome.settings-daemon.plugins.color::night-light-temperature
temperature = 4500

# =============================================================================
# Additional Wayfire Sections (not managed by bridge)
# =============================================================================

[autostart]
# CRITICAL: Required for budgie-desktop to launch correctly
# This section is automatically created by wayfire-bridge if missing
0_env = dbus-update-activation-environment --systemd WAYLAND_DISPLAY DISPLAY XAUTHORITY
autostart_wf_shell = false
portal = /usr/libexec/xdg-desktop-portal
desktop = budgie-desktop

# Auto-start wayfire-bridge (if not using systemd service)
bridge = python3 /usr/libexec/budgie-desktop/wayfire_bridge.py

[idle]
# Idle timeout in seconds (0 = disabled)
toggle = <super> KEY_Z
screensaver_timeout = 300
dpms_timeout = 600

[animate]
# Animation settings
open_animation = zoom
close_animation = zoom
duration = 300

[cube]
# Desktop cube effect
activate = <ctrl> <alt> BTN_LEFT

[expo]
# Workspace overview
toggle = <super>

[grid]
# Window tiling
slot_bl = <super> KEY_KP1
slot_b = <super> KEY_KP2
slot_br = <super> KEY_KP3
slot_l = <super> KEY_LEFT | <super> KEY_KP4
slot_c = <super> KEY_UP | <super> KEY_KP5
slot_r = <super> KEY_RIGHT | <super> KEY_KP6
slot_tl = <super> KEY_KP7
slot_t = <super> KEY_KP8
slot_tr = <super> KEY_KP9

[move]
# Window moving
activate = <super> BTN_LEFT

[resize]
# Window resizing
activate = <super> BTN_RIGHT

[switcher]
# Alt-Tab window switcher
next_view = <alt> KEY_TAB
prev_view = <alt> <shift> KEY_TAB

[vswitch]
# Virtual desktop / workspace switching
# Wayfire uses "viewports" which are equivalent to workspaces in GNOME

# Number of horizontal workspaces
# Synced from: org.gnome.desktop.wm.preferences::num-workspaces
# Note: Wayfire uses a 2D grid, this maps to horizontal workspaces
vwidth = 4

# Number of vertical workspaces (not managed by bridge)
vheight = 1

# Workspace switching keybindings
# Synced from: org.gnome.desktop.wm.keybindings::switch-to-workspace-*
# Format: KEY_X MODIFIER1 MODIFIER2 (space-separated, not pipe-separated)
binding_left = KEY_LEFT CTRL LOGO
binding_right = KEY_RIGHT CTRL LOGO
binding_up = KEY_UP CTRL LOGO
binding_down = KEY_DOWN CTRL LOGO

# Workspace wraparound (not managed by bridge)
wraparound = false

# Duration of workspace switch animation in milliseconds (not managed by bridge)
duration = 300
 
# =============================================================================
# GSETTINGS BRIDGE REFERENCE
# =============================================================================
# The following gsettings schemas are monitored by wayfire_bridge.py:
#
# org.gnome.desktop.interface
#   - cursor-theme → [input] cursor_theme
#   - cursor-size → [input] cursor_size
#   - gtk-theme → [core] gtk_theme
#
# org.gnome.desktop.wm.preferences
#   - button-layout → [decoration] button_order
#   - focus-mode → [core] focus_mode
#   - num-workspaces → [vswitch] vwidth
#
# org.gnome.desktop.wm.keybindings
#   - close → [command] binding_close
#   - maximize → [command] binding_maximize
#   - minimize → [command] binding_minimize
#   - move-to-workspace-left → [command] binding_move_left
#   - move-to-workspace-right → [command] binding_move_right
#   - switch-to-workspace-left → [vswitch] binding_left
#   - switch-to-workspace-right → [vswitch] binding_right
#   - switch-to-workspace-up → [vswitch] binding_up
#   - switch-to-workspace-down → [vswitch] binding_down
#
# org.gnome.desktop.peripherals.mouse
#   - natural-scroll → [input] natural_scroll
#   - accel-profile → [input] mouse_accel_profile
#   - speed → [input] mouse_cursor_speed
#   - left-handed → [input] left_handed_mode
#
# org.gnome.desktop.peripherals.touchpad (libinput)
#   - natural-scroll → [input] touchpad_natural_scroll
#   - tap-to-click → [input] tap_to_click
#   - two-finger-scrolling-enabled → [input] scroll_method
#   - speed → [input] touchpad_cursor_speed
#   - left-handed → [input] touchpad_left_handed_mode
#   - disable-while-typing → [input] disable_while_typing
#   - click-method → [input] click_method
#   - send-events → [input] touchpad_send_events
#
# org.gnome.desktop.peripherals.keyboard
#   - delay → [input] kb_repeat_delay
#   - repeat-interval → [input] kb_repeat_rate (converted to chars/sec)
#   - numlock-state → [input] kb_numlock_default_state
#
# org.gnome.desktop.input-sources
#   - sources → [input] xkb_layout (and xkb_variant if applicable)
#   - xkb-options → [input] xkb_options
#
# org.gnome.settings-daemon.plugins.color
#   - night-light-enabled → [gamma] enabled
#   - night-light-temperature → [gamma] temperature
#
# org.buddiesofbudgie.settings-daemon.plugins.media-keys (static media keys)
#   - terminal → [command] binding_launch_terminal + command_launch_terminal
#   - www → [command] binding_launch_browser + command_launch_browser
#   - email → [command] binding_launch_email + command_launch_email
#   - home → [command] binding_launch_file_manager + command_launch_file_manager
#   - calculator → [command] binding_launch_calculator + command_launch_calculator
#   - magnifier → [command] binding_toggle_magnifier + command_toggle_magnifier
#   - screensaver → [command] binding_lock_screen + command_lock_screen
#   And more media keys as configured...
#
# org.buddiesofbudgie.settings-daemon.plugins.media-keys (custom keybindings)
#   - custom-keybindings → [command] binding_* and command_*
#     Each custom keybinding creates two entries:
#     - binding_{name} = keybinding in Wayfire format
#     - command_{name} = command to execute
#
# =============================================================================
# BRIDGE ARCHITECTURE
# =============================================================================
# The bridge is organized into modules for maintainability:
#
# wayfire_bridge.py              - Main entry point
# wayfire_bridge/
#   ├── __init__.py               - Package initialization
#   ├── bridge.py                 - Core bridge logic and coordinator
#   ├── config_manager.py         - Configuration file I/O operations
#   ├── transforms.py             - Transform functions for value conversion
#   ├── keybindings.py            - Custom keybindings handler
#   ├── media_keys.py             - Static media keys handler
#   └── mappings.py               - Gsettings to Wayfire mappings
# =============================================================================